name: Jeb OS - Check Update

on:
  push:
    branches:
      - main
      - dev
  pull_request:
    branches:
      - main
      - dev

jobs:
  check:
    name: Check C and Assembly Files
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v3

    - name: Set up GCC for Jeb OS
      run: |
        sudo apt update
        sudo apt install -y gcc-arm-none-eabi binutils

    - name: Check C files for syntax errors
      run: |
        for file in $(find . -name "*.c"); do
          gcc -fsyntax-only "$file" || exit 1
        done

    - name: Check Assembly files for syntax errors
      run: |
        for file in $(find . -name "*.s"); do
          as -o /dev/null "$file" || exit 1
        done

    - name: Run static code analysis (cppcheck)
      run: |
        sudo apt install -y cppcheck
        cppcheck --enable=all --inconclusive --force --quiet .
